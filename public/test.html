<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Showroom 配信開始テスト</title>
<style>
body { font-family: sans-serif; padding: 20px; background:#f0f0f0; }
input { padding: 5px; font-size: 1em; width: 120px; }
button { padding: 5px 10px; font-size: 1em; }
pre { background:#fff; padding:10px; border:1px solid #ccc; max-height:400px; overflow:auto; }
</style>
</head>
<body>

<h2>Showroom 配信開始テスト</h2>

<label>Room ID: <input type="text" id="roomIdInput" value="490133"></label>
<button id="fetchBtn">取得</button>

<h3>結果:</h3>
<pre id="result">ここに結果が表示されます</pre>

<script>
document.getElementById("fetchBtn").onclick = async () => {
    const roomId = document.getElementById("roomIdInput").value.trim();
    if(!roomId) return;

    const pre = document.getElementById("result");
    pre.textContent = "取得中...";

    try {
        const res = await fetch(`/room_profile?room_id=${roomId}`);
        if(!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        pre.textContent = JSON.stringify(data, null, 2);

        if(data.current_live_started_at) {
            const startedAt = new Date(data.current_live_started_at * 1000);
            pre.textContent += `\n\n配信開始: ${startedAt.toLocaleString()}`;
        } else {
            pre.textContent += "\n\n未配信";
        }

    } catch(e) {
        pre.textContent = "エラー: " + e.message;
    }
};
</script>

</body>
</html>
